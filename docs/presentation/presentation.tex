\documentclass[aspectratio=169,10pt]{beamer}

\usetheme{Madrid}
\usecolortheme{default}
\usepackage{graphicx}
\usepackage{booktabs}
\usepackage{amsmath}
\usepackage{tikz}
\usepackage{hyperref}
\usetikzlibrary{shapes.geometric, arrows.meta, positioning, fit}

% Custom colors
\definecolor{darkblue}{RGB}{33, 37, 41}
\definecolor{lightblue}{RGB}{66, 133, 244}
\definecolor{greencolor}{RGB}{76, 175, 80}

\setbeamercolor{structure}{fg=darkblue}
\setbeamercolor{frametitle}{bg=lightblue!10,fg=darkblue}

% Remove navigation symbols
\setbeamertemplate{navigation symbols}{}

\title{Satellite NDVI Forecasting with\\Growth Curve Regression}
\subtitle{Project Status Presentation}
\author{Antonio H. X. da Silva}
\date{\today}
\institute{NOVA IMS}

\begin{document}

% =============================================================================
% TITLE SLIDE
% =============================================================================
\begin{frame}
    \titlepage
\end{frame}

% =============================================================================
% PROJECT OVERVIEW
% =============================================================================
\begin{frame}{Project Overview}
    \begin{columns}
        \column{0.5\textwidth}
        \textbf{Objective}
        \begin{itemize}
            \item Forecast vegetation dynamics over 100-day horizon
            \item Multi-spectral Sentinel-2 imagery prediction
            \item Incorporate weather and land cover information
        \end{itemize}
        
        \vspace{0.5cm}
        \textbf{Inspiration}
        \begin{itemize}
            \item Based on ``Explainable Earth Surface Forecasting Under Extreme Events''
            \item Pellicer-Valero et al., 2024
            \item DOI: 10.1029/2024EF005446
        \end{itemize}
        
        \column{0.5\textwidth}
        \textbf{Key Features}
        \begin{itemize}
            \item Historical Sentinel-2 observations (10 frames, 50 days)
            \item E-OBS climate variables (7 weather features)
            \item ESA WorldCover land classification
            \item Growth curve parametric decoder
        \end{itemize}
    \end{columns}
\end{frame}

% =============================================================================
% MODEL ARCHITECTURE
% =============================================================================
\begin{frame}{Model Architecture (Simplified)}        
    \begin{center}
        \begin{figure}
            \centering
            \includegraphics[width=0.7\textwidth]{images/ModelArchitecture.drawio.png}
        \end{figure}
    \end{center}

    \begin{center}
        \begin{block}{Growth Curve Formula}
            $\delta(t) = A \cdot (1 - e^{-\lambda \cdot T \cdot t \cdot \text{adj}(t))}) + B$ 
            where
            $t \in [0,1]$, \quad 
            $T=20$ \quad and
            $\text{adj}(t) \in [0.5, 1.5]$
        \end{block}
    \end{center}
\end{frame}

% =============================================================================
% LOSS FUNCTION
% =============================================================================
\begin{frame}{Loss Function: Improved kNDVI Loss}
    \begin{columns}
        \column{0.55\textwidth}
        \textbf{Components (normalized to similar scales)}
        
        \vspace{0.3cm}
        \begin{enumerate}
            \item \textbf{Regression Loss} (Huber $\delta=0.1$)
            \begin{equation*}
                \mathcal{L}_{\text{reg}} = \text{Huber}(\delta_{\text{true}}, \delta_{\text{pred}}) \times (1 - m_{\text{cloud}})
            \end{equation*}
            
            \item \textbf{Variance Penalty}
            \begin{equation*}
                \mathcal{L}_{\text{var}} = |\text{Var}_{\text{spatial}}(\delta_{\text{true}}) - \text{Var}_{\text{spatial}}(\delta_{\text{pred}})|
            \end{equation*}
            
            \item \textbf{kNDVI Loss} (RBF kernel $\sigma=0.5$)
            \begin{equation*}
                \text{kNDVI} = \frac{1 - k(n,r)}{1 + k(n,r)}, \quad k(n,r) = e^{-\frac{(n-r)^2}{2\sigma^2}}
            \end{equation*}
        \end{enumerate}
        
        \column{0.45\textwidth}
        \begin{block}{Combined Loss}
            $\mathcal{L} = w_{\text{reg}} \cdot \mathcal{L}_{\text{reg}} + w_{\text{var}} \cdot \mathcal{L}_{\text{var}} + w_{\text{kndvi}} \cdot \mathcal{L}_{\text{kndvi}}$
        \end{block}
        
        \vspace{0.3cm}
        \begin{table}
            \centering
            \small
            \begin{tabular}{lc}
                \toprule
                \textbf{Component} & \textbf{Weight} \\
                \midrule
                Regression & 10.0 \\
                Variance & 1.0 \\
                kNDVI & 0.0 $\rightarrow$ 1.0 \\
                \bottomrule
            \end{tabular}
        \end{table}
        
        \vspace{0.3cm}
        \footnotesize
        \textit{kNDVI enabled after epoch 20 via callback}
    \end{columns}
\end{frame}

% =============================================================================
% TEMPORAL SAMPLING
% =============================================================================
\begin{frame}{Temporal Sampling Strategy}
    \begin{center}
        \includegraphics[width=0.9\textwidth]{images/material/temporal_sampling.png}
    \end{center}
    
    \vspace{0.3cm}
    \begin{columns}
        \column{0.5\textwidth}
        \textbf{Input Period}
        \begin{itemize}
            \item Days 4--49 (50 days)
            \item 10 frames at 5-day intervals
        \end{itemize}
        
        \column{0.5\textwidth}
        \textbf{Target Period}
        \begin{itemize}
            \item Days 54--149 (100 days)
            \item 20 frames at 5-day intervals
        \end{itemize}
    \end{columns}
\end{frame}

% =============================================================================
% LANDCOVER DISTRIBUTION
% =============================================================================
\begin{frame}{Land Cover Distribution (ESA WorldCover)}
    \begin{center}
        \includegraphics[width=\textwidth]{images/material/landcover_distribution.png}
    \end{center}
\end{frame}

% =============================================================================
% RESULTS - ERROR METRICS
% =============================================================================
\begin{frame}{Results: Error Metrics}
    \begin{columns}
        \column{0.4\textwidth}
        \begin{table}
            \centering
            \begin{tabular}{lcc}
                \toprule
                \textbf{Band} & \textbf{MAE} & \textbf{RMSE} \\
                \midrule
                B02 (Blue) & 0.029 & 0.057 \\
                B03 (Green) & 0.032 & 0.058 \\
                B04 (Red) & 0.041 & 0.066 \\
                B8A (NIR) & 0.053 & 0.077 \\
                \midrule
                \textbf{Overall} & \textbf{0.039} & \textbf{0.064} \\
                \bottomrule
            \end{tabular}
            \caption{Per-band error metrics}
        \end{table}
        
        \vspace{0.3cm}
        \textbf{Observations}
        \begin{itemize}
            \item NIR band has highest error
            \item Blue band has lowest error
            \item Errors in reasonable range for delta prediction
        \end{itemize}
        
        \column{0.6\textwidth}
        \begin{figure}
            \centering
            \includegraphics[width=\textwidth]{images/results/temporal_error.png}
            \caption{Prediction error over forecast horizon by spectral band}
        \end{figure}
    \end{columns}
\end{frame}

% =============================================================================
% RESULTS - PREDICTION COMPARISON
% =============================================================================
\begin{frame}{Results: Prediction Comparison (Sample 1)}
    \begin{center}
        \includegraphics[width=0.9\textwidth]{images/results/prediction_comparison_1.png}
    \end{center}
    \vspace{-0.3cm}
    \footnotesize \textit{Ground truth vs. predicted reflectance deltas across forecast timesteps}
\end{frame}

\begin{frame}{Results: Prediction Comparison (Sample 2)}
    \begin{center}
        \includegraphics[width=0.9\textwidth]{images/results/prediction_comparison_2.png}
    \end{center}
    \vspace{-0.3cm}
    \footnotesize \textit{Ground truth vs. predicted reflectance deltas across forecast timesteps}
\end{frame}

% =============================================================================
% RESULTS - SPATIAL ERROR
% =============================================================================
\begin{frame}{Results: Spatial Error Distribution}
    \begin{columns}
        \column{0.5\textwidth}
        \begin{center}
            \includegraphics[width=0.9\textwidth]{images/results/spatial_error_heatmap.png}
        \end{center}
        
        \column{0.5\textwidth}
        \textbf{Spatial Error Analysis}
        \begin{itemize}
            \item Error distribution across image
            \item Identifies challenging regions
            \item Useful for model improvement
        \end{itemize}
        
        \vspace{0.5cm}
        \textbf{Key Insights}
        \begin{itemize}
            \item Edges may have higher error
            \item Heterogeneous areas more challenging
            \item Cloud boundaries affect accuracy
        \end{itemize}
    \end{columns}
\end{frame}

% =============================================================================
% VALIDATION STRATEGY
% =============================================================================
\begin{frame}{Validation Strategy (GreenEarthNet)}
    \begin{columns}
        \column{0.5\textwidth}
        \textbf{Dataset Splits}
        \begin{itemize}
            \item \textbf{Train}: 23,816 minicubes (85 tiles)
            \item \textbf{val\_chopped}: IID validation set
            \item \textbf{ood-t}: Out-of-distribution temporal
            \item \textbf{ood-s}: Out-of-distribution spatial
            \item \textbf{ood-st}: Out-of-distribution spatio-temporal
        \end{itemize}
        
        \vspace{0.3cm}
        \textbf{Evaluation Protocol}
        \begin{itemize}
            \item 50 days context $\rightarrow$ 100 days target (IID/OOD)
            \item Primary validation on \texttt{val\_chopped}
            \item Generalization testing on OOD splits
        \end{itemize}
        
        \column{0.5\textwidth}
        \textbf{Vegetation Score (NSE-based)}
        \begin{equation*}
            \text{NSE} = 1 - \frac{\sum(y - \hat{y})^2}{\sum(y - \bar{y})^2}
        \end{equation*}
        \begin{itemize}
            \item Computed on cloud-free vegetation pixels
            \item Normalized: $\text{nNSE} = \frac{1}{2 - \text{NSE}}$
            \item Averaged over Trees, Scrub, Grassland
            \item Score: 1 = perfect, 0 = climatology
        \end{itemize}
        
    \end{columns}
\end{frame}

% =============================================================================
% MODEL COMPARISON
% =============================================================================
\begin{frame}{Model Comparison (GreenEarthNet Benchmark)}
    \begin{table}
        \centering
        \small
        \begin{tabular}{lccc}
            \toprule
            \textbf{Model} & \textbf{Parameters} & \textbf{Type} & \textbf{Veg. Score$\uparrow$} \\
            \midrule
            ConvLSTM & $\sim$2M & RNN-based & 0.21 \\
            SGED-ConvLSTM & $\sim$3M & RNN-based & 0.24 \\
            PredRNN & $\sim$24M & Video Pred. & 0.19 \\
            SimVP & $\sim$22M & Video Pred. & 0.22 \\
            Earthformer & $\sim$12M & Transformer & 0.28 \\
            \textbf{Contextformer} & \textbf{6M} & \textbf{Transformer} & \textbf{0.31} \\
            \midrule
            \textcolor{greencolor}{\textbf{Ours (Growth Curve Reg.)}} & \textcolor{greencolor}{\textbf{$\leq$1M}} & \textcolor{greencolor}{\textbf{RNN-Based}} & \textcolor{greencolor}{\textbf{TBD}} \\
            \bottomrule
        \end{tabular}
        \caption{Model comparison on GreenEarthNet IID validation. Scores from Benson et al., CVPR 2024.}
    \end{table}
    
    \vspace{0.05cm}
    \textbf{Key Differentiators of Our Approach:}
    \begin{itemize}
        \item Parametric growth curve decoder for interpretable predictions
        \item Significantly fewer parameters ($\sim$6$\times$ smaller than Contextformer)
        \item Explicit modeling of vegetation phenology dynamics
    \end{itemize}
\end{frame}

% =============================================================================
% NEXT STEPS
% =============================================================================
\begin{frame}{Next Steps}
    \begin{columns}
        \column{0.5\textwidth}
        \textbf{1. Full Dataset Training}
        \begin{itemize}
            \item Currently: 200 training samples
            \item Target: Full GreenEarthNet (23,816 samples)
            \item Estimated training time: $\sim$48h on GPU
        \end{itemize}
        
        \vspace{0.5cm}
        \textbf{2. Benchmark Evaluation}
        \begin{itemize}
            \item Compute Vegetation Score on val\_chopped
            \item Evaluate on OOD test sets
            \item Compare with Contextformer baselines
        \end{itemize}
        
        \column{0.5\textwidth}
        \textbf{3. Model Improvements}
        \begin{itemize}
            \item Hyperparameter tuning
            \item Loss weights optimization
            \item Architecture refinements
        \end{itemize}
        
        \vspace{0.5cm}
        \textbf{4. Analysis}
        \begin{itemize}
            \item Per-landcover performance breakdown
            \item Extreme event case studies
            \item Growth curve interpretability analysis
        \end{itemize}
    \end{columns}
\end{frame}

% =============================================================================
% REFERENCES
% =============================================================================
\begin{frame}{References}
    \footnotesize
    \begin{enumerate}
        \item \textbf{Benson, V., Robin, C., Requena-Mesa, C., Alonso, L., Carvalhais, N., Cort√©s, J., Gao, Z., Linscheid, N., Weynants, M., \& Reichstein, M.} (2024). \\
        \textit{Multi-modal learning for geospatial vegetation forecasting}. \\
        Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR). \\
        \textcolor{lightblue}{\url{https://arxiv.org/abs/2303.16198}}
        
        \vspace{0.4cm}
        \item \textbf{Pellicer-Valero, O. J., Robin, C., \& Reichstein, M.} (2024). \\
        \textit{Explainable Earth Surface Forecasting Under Extreme Events}. \\
        Earth's Future, 12, e2024EF005446. \\
        \textcolor{lightblue}{\url{https://doi.org/10.1029/2024EF005446}}
    \end{enumerate}
\end{frame}

% =============================================================================
% THANK YOU
% =============================================================================
\begin{frame}
    \centering
    \Huge Thank You!
    
    \vspace{1cm}
    \normalsize Questions?
\end{frame}

\end{document}
